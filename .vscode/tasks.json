{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "Build",
            "type": "shell",
            "dependsOn": "_makebuildfolder",
            "group": "build",
            "presentation": {
                "reveal": "always",
                "clear": true
            },
            "options": {
                "cwd": "${workspaceFolder}/build",
            },
            "windows" : {
                "problemMatcher": "$msCompile",
                "command": "..\\cl.bat",
                "args" : [
                    "/W4",
                    "/WX",
                    "/EHsc",
                    "/std:c++20",
                    "${workspaceFolder}/src/main.cpp",
                    "/link",
                    "/out:${workspaceFolder}/bin/mpidemo.exe"
                ]
            },
            "linux" : {
                "problemMatcher": "$gcc",
                "command": "g++",
                "args" : [
                    "${workspaceFolder}/src/main.cpp",
                    "-O3",
                    "-std=c++17",
                    "-Werror",
                    "-Wall",
                    "-Wextra",
                    "-Wpedantic",
                    "-Wconversion",
                    "-o",
                    "${workspaceFolder}/bin/mpi-demo"
                ]
            }
        },
        {
          "label": "_makebuildfolder",
          "type": "shell",
          "linux": {
              "command": "mkdir",
              "args": [
                "-p",
                "${workspaceFolder}/build",
                "${workspaceFolder}/bin"
            ]
          },
          "windows": {
            "command": "mkdir",
              "args": [
                "-Force",
                "${workspaceFolder}\\build,",
                "${workspaceFolder}\\bin"
            ]
          },
          "problemMatcher": [],
          "group": "none"
        }
    ]
}